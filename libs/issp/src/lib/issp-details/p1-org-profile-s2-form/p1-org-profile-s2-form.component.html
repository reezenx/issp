<ng-container *ngIf="!isDepartmentWide(); else departmentWide">
  <div [formGroup]="form" (ngSubmit)="save()">
    <h5 class="m-b-0">B.1. Name of Designated IS Planner</h5>
    <div class="m-b-16">
      <span class="f-s-12 bg-light-primary text-gray-100 rounded p-6 p-y-4">
        Please refer to page ii-c no. 17 for the definition of IS Planner.
      </span>
    </div>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600">Name</mat-label>
      <mat-icon matPrefix class="op-5">
        <i-tabler name="user" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b1PlannerName
        matInput
        formControlName="b1PlannerName"
        placeholder="Enter Name"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b1PlannerName'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b1PlannerName.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b1PlannerName'].touched && f['b1PlannerName'].invalid) {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b1PlannerName'].errors && f['b1PlannerName'].errors['required'])
        {
        <div class="text-error">Name is required.</div>
        }
      </mat-hint>
      }
    </mat-form-field>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600">Plantilla Position</mat-label>
      <mat-icon matPrefix class="op-5">
        <i-tabler name="user-hexagon" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b1PlantillaPosition
        matInput
        formControlName="b1PlantillaPosition"
        placeholder="Enter Position"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b1PlantillaPosition'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b1PlantillaPosition.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b1PlantillaPosition'].touched && f['b1PlantillaPosition'].invalid)
      {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b1PlantillaPosition'].errors &&
        f['b1PlantillaPosition'].errors['required']) {
        <div class="text-error">Plantilla Position is required.</div>
        }
      </mat-hint>
      }
    </mat-form-field>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600">Organizational Unit</mat-label>
      <mat-icon matPrefix class="op-5">
        <i-tabler name="affiliate" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b1OrgUnit
        matInput
        formControlName="b1OrgUnit"
        placeholder="Enter Organization Unit"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b1OrgUnit'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b1OrgUnit.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b1OrgUnit'].touched && f['b1OrgUnit'].invalid) {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b1OrgUnit'].errors && f['b1OrgUnit'].errors['required']) {
        <div class="text-error">Organizational Unit is required.</div>
        }
      </mat-hint>
      }
    </mat-form-field>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600">E-mail Address</mat-label>
      <mat-icon matPrefix class="op-5">
        <i-tabler name="mail" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b1Email
        matInput
        formControlName="b1Email"
        placeholder="Enter Position"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b1Email'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b1Email.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b1Email'].touched && f['b1Email'].invalid) {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b1Email'].errors && f['b1Email'].errors['required']) {
        <div class="text-error">Email is required.</div>
        }@if(f['b1Email'].errors && f['b1Email'].errors['b1Email']) {
        <div class="text-error">
          Email should be in format (name&#64;agency.com)
        </div>
        } @if(f['b1Email'].errors && f['b1Email'].errors['notUnique']) {
        <div class="text-error">b1Email already exists.</div>
        }
      </mat-hint>
      }
    </mat-form-field>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600">Contact Number/s</mat-label>
      <mat-icon matPrefix class="op-5">
        <i-tabler name="phone" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b1Contacts
        matInput
        formControlName="b1Contacts"
        placeholder="Enter Contacts"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b1Contacts'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b1Contacts.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b1Contacts'].touched && f['b1Contacts'].invalid) {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b1Contacts'].errors && f['b1Contacts'].errors['required']) {
        <div class="text-error">Contact is required.</div>
        }
      </mat-hint>
      }
    </mat-form-field>

    <h5 class="m-b-0">B.2. Current Annual ICT Budget</h5>
    <div class="m-b-16">
      <span class="f-s-12 bg-light-primary text-gray-100 rounded p-6 p-y-4">
        Indicate the Total Annual ICT Budget for the current fiscal year. Other
        possible sources of funds should be indicated separately
      </span>
    </div>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600">Annual ICT Budget</mat-label>
      <mat-icon matPrefix class="op-5">
        <i-tabler name="currency-peso" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b2AnnualICTBudget
        matInput
        type="number"
        formControlName="b2AnnualICTBudget"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b2AnnualICTBudget'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b2AnnualICTBudget.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b2AnnualICTBudget'].touched && f['b2AnnualICTBudget'].invalid) {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b2AnnualICTBudget'].errors &&
        f['b2AnnualICTBudget'].errors['required']) {
        <div class="text-error">Annual ICT Budget is required.</div>
        } @if(f['b2AnnualICTBudget'].errors &&
        f['b2AnnualICTBudget'].errors['min']) {
        <div class="text-error">Annual ICT Budget minimum is 1.</div>
        }
      </mat-hint>
      }
    </mat-form-field>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600"
        >Other Sources of Funds</mat-label
      >
      <mat-icon matPrefix class="op-5">
        <i-tabler name="brand-bitbucket" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b2OtherSources
        matInput
        formControlName="b2OtherSources"
        placeholder="Enter Contacts"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b2OtherSources'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b2OtherSources.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b2OtherSources'].touched && f['b2OtherSources'].invalid) {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b2OtherSources'].errors &&
        f['b2OtherSources'].errors['required']) {
        <div class="text-error">Other Sources of Funds is required.</div>
        }
      </mat-hint>
      }
    </mat-form-field>

    <h5 class="m-b-0">B.3. Organizational Structure</h5>
    <div class="m-b-16">
      <span class="f-s-12 bg-light-primary text-gray-100 rounded p-6 p-y-4">
        Indicate the total number of employees including those on part-time or
        full-time basis, regular, contractual and casual employees and those
        assigned to regional/extension, provincial and other offices. Indicate
        the number of regional offices, provincial offices and other offices, if
        any.
      </span>
    </div>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600"
        >Total No. of Employees</mat-label
      >
      <mat-icon matPrefix class="op-5">
        <i-tabler name="user-hexagon" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b3TotalNoEmp
        matInput
        type="number"
        formControlName="b3TotalNoEmp"
        placeholder="Enter Position"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b3TotalNoEmp'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b3TotalNoEmp.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b3TotalNoEmp'].touched && f['b3TotalNoEmp'].invalid) {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b3TotalNoEmp'].errors && f['b3TotalNoEmp'].errors['required']) {
        <div class="text-error">Total No. of Employees is required.</div>
        }
      </mat-hint>
      }
    </mat-form-field>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600"
        >No. of Regional/Extension Offices</mat-label
      >
      <mat-icon matPrefix class="op-5">
        <i-tabler name="building" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b3NoRegionalOffices
        matInput
        type="number"
        formControlName="b3NoRegionalOffices"
        placeholder="Enter Organization Unit"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b3NoRegionalOffices'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b3NoRegionalOffices.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b3NoRegionalOffices'].touched && f['b3NoRegionalOffices'].invalid)
      {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b3NoRegionalOffices'].errors &&
        f['b3NoRegionalOffices'].errors['required']) {
        <div class="text-error">
          No. of Regional/Extension Offices is required.
        </div>
        }
      </mat-hint>
      }
    </mat-form-field>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600"
        >No. of Provincial Offices</mat-label
      >
      <mat-icon matPrefix class="op-5">
        <i-tabler name="building-arch" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b3NoProvOffices
        matInput
        type="number"
        formControlName="b3NoProvOffices"
        placeholder="Enter Position"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b3NoProvOffices'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b3NoProvOffices.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b3NoProvOffices'].touched && f['b3NoProvOffices'].invalid) {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b3NoProvOffices'].errors &&
        f['b3NoProvOffices'].errors['required']) {
        <div class="text-error">No. of Provincial Offices is required.</div>
        }
      </mat-hint>
      }
    </mat-form-field>
    <mat-form-field appearance="outline" class="w-100 m-b-10" color="primary">
      <mat-label class="mat-subtitle-2 f-w-600"
        >No. of Other Offices (e.g. District, Field, etc.)</mat-label
      >
      <mat-icon matPrefix class="op-5">
        <i-tabler name="building-estate" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      <input
        #b3NoOthersOffices
        matInput
        type="number"
        formControlName="b3NoOthersOffices"
        placeholder="Enter Contacts"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        class="m-r-4"
        (click)="f['b3NoOthersOffices'].patchValue('')"
        [attr.aria-label]="'Clear'"
        [disabled]="!b3NoOthersOffices.value"
      >
        <mat-icon class="op-5">
          <i-tabler name="backspace" class="icon-18 d-flex"></i-tabler>
        </mat-icon>
      </button>
      @if(f['b3NoOthersOffices'].touched && f['b3NoOthersOffices'].invalid) {
      <mat-hint [align]="'end'" class="m-b-16 error-msg">
        @if(f['b3NoOthersOffices'].errors &&
        f['b3NoOthersOffices'].errors['required']) {
        <div class="text-error">No. of Other Offices is required.</div>
        }
      </mat-hint>
      }
    </mat-form-field>
  </div>
</ng-container>
<ng-template #departmentWide>
  <div [formGroup]="form" (ngSubmit)="save()">
    <h5 class="m-b-0">Table B-1 (For Department-Wide Organizations Only)</h5>

    <span class="f-s-12 bg-light-primary text-gray-100 rounded p-6 p-y-4">
      For each organizational unit: <br />
      1 - List all bureaus, attached agencies, and
      regional/extension/field/provincial offices (if any) under the control and
      supervision of the department. <br />
      2 - Indicate the complete name of the agency head. <br />
      3 - Indicate the complete name of the IS Planner of each unit, their
      respective plantilla position, e-mail address/es and contact number/s.
      <br />
      4 - Indicate the total number of employees to include part-time or
      full-time basis, regular, contractual and casual employees. <br />
      5 - State the Total Annual ICT Budget (as reported per GAA) for the
      current fiscal year. <br />
    </span>
  </div>
  <div class="m-t-16">
    <ejs-grid
      #itemsGrid
      data-test="items-grid"
      [allowExcelExport]="true"
      [allowFiltering]="true"
      [allowPaging]="true"
      [allowPdfExport]="true"
      [allowResizing]="true"
      [allowSorting]="true"
      [allowGrouping]="true"
      [autoFit]="true"
      [showColumnChooser]="true"
      [showColumnMenu]="true"
      [dataSource]="gridData"
      [filterSettings]="filterSettings"
      [groupSettings]="groupSettings"
      [sortSettings]="sortSettings"
      [editSettings]="editSettings"
      [id]="gridId"
      [loadingIndicator]="loadingIndicator"
      [pageSettings]="gridPageSettings"
      [toolbar]="toolbar"
      (toolbarClick)="toolbarClick($event)"
      (created)="created()"
      (actionBegin)="actionBegin($event)"
      (actionComplete)="actionComplete($event)"
    >
      <e-columns>
        <e-column
          headerText="Organizational Unit (1)"
          field="b1OrgUnit"
          [edit]="stringParams"
          [validationRules]="requiredRule"
        ></e-column>
        <e-column
          headerText="Name of Agency Head (2)"
          field="b1AgencyHeadName"
          [edit]="stringParams"
          [validationRules]="requiredRule"
        ></e-column>
        <e-column
          headerText="DESIGNATED IS PLANNER (3)"
          [columns]="designatedISPlannerColumns"
          textAlign="center"
        ></e-column>
        <e-column
          headerText="Number of Employees (4)"
          field="b3TotalNoEmp"
          editType="numericedit"
          [edit]="numericParams"
          format="N0"
          [validationRules]="b3TotalNoEmpRule"
        ></e-column>
        <e-column
          headerText="(₱) Current Annual ICT Budget (5)"
          field="b2AnnualICTBudget"
          editType="numericedit"
          format="N2"
          [validationRules]="b2AnnualICTBudgetRule"
        ></e-column>
        <e-column headerText="Created By" field="createdBy" [visible]="false">
        </e-column>
        <e-column headerText="Created At" field="createdAt" [visible]="false">
          <ng-template #template let-data>
            {{ data.createdAt | date : 'medium' }}
          </ng-template>
        </e-column>
        <e-column headerText="Updated By" field="updatedBy" [visible]="false">
        </e-column>
        <e-column headerText="Id" field="id" [visible]="false"> </e-column>
        <e-column headerText="ISSP Id" field="isspId" [visible]="false">
        </e-column>
        <e-column headerText="Updated At" field="updatedAt" [visible]="false">
          <ng-template #template let-data>
            {{ data.updatedAt | date : 'medium' }}
          </ng-template>
        </e-column>
        <!-- <e-column headerText="Actions" field="actions" textAlign="center">
            <ng-template #template let-data>
              <ng-container *ngIf="data.readOnly; else notReadOnly">
                <button
                  mat-icon-button
                  color="primary"
                  type="button"
                  matTooltip="ISSP is readonly"
                >
                  <mat-icon matSuffix>
                    <i-tabler name="lock" class="icon-20"></i-tabler>
                  </mat-icon>
                </button>
              </ng-container>
              <ng-template #notReadOnly>
                <button
                  mat-icon-button
                  color="primary"
                  type="button"
                  *ngIf="!data.workPackageId"
                  (click)="editItem(data.id)"
                  matTooltip="Edit ISSP"
                >
                  <mat-icon matSuffix>
                    <i-tabler name="pencil" class="icon-20"></i-tabler>
                  </mat-icon>
                </button>
              </ng-template>
            </ng-template>
          </e-column> -->
      </e-columns>
    </ejs-grid>
  </div>
</ng-template>
